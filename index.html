<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Machine Noise</title>
<style>
input[type=range]{
    -webkit-appearance: none;
}

input[type=range]::-webkit-slider-runnable-track {
    width: 300px;
    height: 5px;
    background: #ddd;
    border: none;
    border-radius: 3px;
}

input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    border: none;
    height: 16px;
    width: 16px;
    border-radius: 50%;
    background: goldenrod;
    margin-top: -4px;
}

input[type=range]:focus {
    outline: none;
}

input[type=range]:focus::-webkit-slider-runnable-track {
    background: #ccc;
}
</style>
</head>

<body style="text-align:center; background:#00AA44;">

<input type="button" value="White noise" onclick="toggle_play('white');" style="display:block; margin:auto; width:50%; height:20%; padding:30px;"/>

<input id="volume-slider" type="range" min="0.0" max="1.0" step="0.01" style="display:block; margin:auto; width:50%; height:20%; padding:20px;"/>

<script>

var exponent = 14; // anything between 8 and 14 is OK
var bufferSize = 2 << (exponent-1);
var context = new AudioContext();
var sounds = {};
sounds['white'] = context.createScriptProcessor(bufferSize, 0, 2);
sounds['white'].playing = false;
var volume_slider = document.getElementById('volume-slider');
volume_slider.value = 0.1;

sounds['white'].onaudioprocess = function(e) {
  var outputBuffer = e.outputBuffer;
  for (var channel = 0; channel < outputBuffer.numberOfChannels; channel++) {
    var outputData = outputBuffer.getChannelData(channel);
    for (var i = 0; i < bufferSize; i++) {
      outputData[i] = volume_slider.value * ( Math.random()*2-1 ); // audio points are in range [-1.0,1.0]
    }
  }
}

function toggle_play(sound_name) {
  var sound = sounds[sound_name];
  if(!sound.playing) {
    sound.connect(context.destination);
  } else {
    sound.disconnect(context.destination);
  }
  sound.playing = !sound.playing;
}

</script>
</body>
</html>

