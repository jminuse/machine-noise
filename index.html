<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Machine Noise</title>
</head>

<body>

<button onclick="toggle_play('white')">White noise</button>

<script>

var context = null;
var sounds = {};

function initialize_sound() {
  var exponent = 14; // anything between 8 and 14 is OK
  var bufferSize = 2 << (exponent-1);
  context = new AudioContext();
  sounds['white'] = context.createScriptProcessor(bufferSize, 0, 2);
  sounds['white'].playing = false;
}
initialize_sound();

sounds['white'].onaudioprocess = function(e) {
  var outputBuffer = e.outputBuffer;
  for (var channel = 0; channel < outputBuffer.numberOfChannels; channel++) {
    var outputData = outputBuffer.getChannelData(channel);
    for (var i = 0; i < bufferSize; i++) {
      outputData[i] = Math.random()*2-1; // audio points are in range [-1.0,1.0]
    }
  }
}

function toggle_play(sound_name) {
  var sound = sounds[sound_name];
  if(!sound.playing) {
    sound.connect(context.destination);
  } else {
    sound.disconnect(context.destination);
  }
  sound.playing = !sound.playing;
}

</script>
</body>
</html>

