<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Machine Noise</title>
</head>

<body>

<button onclick="toggle_play()">Toggle Play</button>

<script>

var playing = false;
var context = null;
var whiteNoise = null;

var initialize_white_noise = function(){
  var exponent = 14; // anything between 8 and 14 is OK
  var bufferSize = 2 << (exponent-1);
  context = new AudioContext();
  whiteNoise = context.createScriptProcessor(bufferSize, 0, 2);
  whiteNoise.onaudioprocess = function(e) {
    var outputBuffer = e.outputBuffer;
    for (var channel = 0; channel < outputBuffer.numberOfChannels; channel++) {
      var outputData = outputBuffer.getChannelData(channel);
      for (var i = 0; i < bufferSize; i++) {
        outputData[i] = Math.cos((new Date())*0.001) * Math.random()*2-1;
      }
    }
  }
}
initialize_white_noise();

function toggle_play() {
  if(!playing) {
    whiteNoise.connect(context.destination);
  } else {
    whiteNoise.disconnect(context.destination);
  }
  playing = !playing;
}

</script>
</body>
</html>

